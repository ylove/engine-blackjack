module.exports=function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.i=function(a){return a},b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=8)}([function(a,b){'use strict';Object.defineProperty(b,'__esModule',{value:!0});var c=b.INVALID='INVALID',d=b.RESTORE='RESTORE',e=b.DEAL='DEAL',f=b.INSURANCE='INSURANCE',g=b.SPLIT='SPLIT',h=b.HIT='HIT',i=b.DOUBLE='DOUBLE',j=b.STAND='STAND',k=b.SURRENDER='SURRENDER',l=b.SHOWDOWN='SHOWDOWN',m=b.DEALER_HIT='DEALER-HIT',n=b.RIGHT='right',o=b.LEFT='left',p=b.STAGE_READY='ready',q=b.STAGE_PLAYER_TURN_RIGHT='player-turn-right',r=b.STAGE_PLAYER_TURN_LEFT='player-turn-left',s=b.STAGE_SHOWDOWN='showdown',t=b.STAGE_DEALER_TURN='dealer-turn',u=b.STAGE_DONE='done'},function(a,b,c){'use strict';Object.defineProperty(b,'__esModule',{value:!0}),b.dealerHit=b.showdown=b.surrender=b.stand=b.double=b.hit=b.split=b.insurance=b.deal=b.restore=b.invalid=void 0;var d=c(0),e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(d),f=b.invalid=function(a,b){return{type:e.INVALID,payload:{type:a.type,payload:a.payload,info:b}}},g=b.restore=function(){return{type:e.RESTORE}},h=b.deal=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},b=a.bet,c=b===void 0?10:b,d=a.sideBets,f=d===void 0?{luckyLucky:0}:d;return{type:e.DEAL,payload:{bet:c,sideBets:f}}},i=b.insurance=function(a){var b=a.bet,c=b===void 0?0:b;return{type:e.INSURANCE,payload:{bet:c}}},j=b.split=function(){return{type:e.SPLIT}},k=b.hit=function(a){var b=a.position,c=b===void 0?'right':b;return{type:e.HIT,payload:{position:c}}},l=b.double=function(a){var b=a.position,c=b===void 0?'right':b;return{type:e.DOUBLE,payload:{position:c}}},m=b.stand=function(a){var b=a.position,c=b===void 0?'right':b;return{type:e.STAND,payload:{position:c}}},n=b.surrender=function(){return{type:e.SURRENDER}},o=b.showdown=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},b=a.dealerHoleCardOnly;return{type:e.SHOWDOWN,payload:{dealerHoleCardOnly:b!==void 0&&b}}},p=b.dealerHit=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},b=a.dealerHoleCard;return{type:e.DEALER_HIT,payload:{dealerHoleCard:b}}}},function(a,b,c){'use strict';Object.defineProperty(b,'__esModule',{value:!0}),b.getPrizes=b.getPrize=b.isActionAllowed=b.getSideBetsInfo=b.isPerfectPairs=b.getLuckyLuckyMultiplier=b.isLuckyLucky=b.getHandInfoAfterInsurance=b.getHandInfoAfterSurrender=b.getHandInfoAfterStand=b.getHandInfoAfterDouble=b.getHandInfoAfterHit=b.getHandInfoAfterSplit=b.getHandInfoAfterDeal=b.getHandInfo=b.countCards=b.isSuited=b.isSoftHand=b.isBlackjack=b.checkForBusted=b.getHigherValidValue=b.calculate=b.isNullOrUndef=b.isUndefined=b.isNull=void 0;var d=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},e=c(7),f=function(a){return a&&a.__esModule?a:{default:a}}(e),g=c(0),h=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(g),i=b.isNull=function(a){return null===a},j=b.isUndefined=function(a){return a===void 0},k=b.isNullOrUndef=function(a){return j(a)||i(a)},l=b.calculate=function(a){if(1===a.length){if(k(a[0]))return null;var b=a[0].value;return{hi:1===b?11:b,lo:1===b?1:b}}var c=[],d=a.reduce(function(a,b){return 1===b.value?(c.push(1),a):(a+=b.value,a)},0);return c.reduce(function(a){return 21>=a.hi+11?(a.hi+=11,a.lo+=1):(a.hi+=1,a.lo+=1),21<a.hi&&21>=a.lo&&(a.hi=a.lo),a},{hi:d,lo:d})},m=b.getHigherValidValue=function(a){return 21>=a.hi?a.hi:a.lo},n=b.checkForBusted=function(a){return 21<a.hi&&a.lo===a.hi},o=b.isBlackjack=function(a){return 2===a.length&&21===l(a).hi},p=b.isSoftHand=function(a){return a.some(function(a){return 1===a.value})&&17===a.reduce(function(a,b){return a+=1===b.value&&11>a?11:b.value,a},0)},q=b.isSuited=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[];if(0===a.length)return!1;var b=a[0].suite;return a.every(function(a){return a.suite===b})},r=b.countCards=function(a){var b={"Hi-Lo":[-1,1,1,1,1,1,0,0,0,-1,-1,-1,-1]};return a.reduce(function(a,c){return a+=b['Hi-Lo'][c.value-1],a},0)},s=b.getHandInfo=function(a,b){var c=2<arguments.length&&arguments[2]!==void 0&&arguments[2],d=l(a);if(!d)return null;var e=o(a)&&!1===c,f=n(d),g=f||e||21===d.hi,h=1<a.length&&a[0].value===a[1].value&&!g,i=1===b[0].value&&!g;return{cards:a,playerValue:d,playerHasBlackjack:e,playerHasBusted:f,playerHasSurrendered:!1,close:g,availableActions:{double:!g&&!0,split:h,insurance:i,hit:!g,stand:!g,surrender:!g}}},t=b.getHandInfoAfterDeal=function(a,b,c){var e=s(a,b);e.bet=c;var f=e.availableActions;return e.availableActions=d({},f,{stand:!0,hit:!0,surrender:!0}),d({},e,{close:e.playerHasBlackjack})},u=b.getHandInfoAfterSplit=function(a,b,c){var e=s(a,b,!0),f=e.availableActions;return e.availableActions=d({},f,{split:!1,double:!e.close&&2===a.length,insurance:!1,surrender:!1}),e.bet=c,e},v=b.getHandInfoAfterHit=function(a,b,c,e){var f=s(a,b,e),g=f.availableActions;return f.availableActions=d({},g,{double:2===a.length,split:!1,insurance:!1,surrender:!1}),f.bet=c,f},w=b.getHandInfoAfterDouble=function(a,b,c,e){var f=v(a,b,c,e),g=f.availableActions;return f.availableActions=d({},g,{hit:!1,stand:!1}),f.bet=2*c,d({},f,{close:!0})},x=b.getHandInfoAfterStand=function(a){return d({},a,{close:!0,availableActions:{double:!1,split:!1,insurance:!1,hit:!1,stand:!1,surrender:!1}})},y=b.getHandInfoAfterSurrender=function(a){var b=x(a);return d({},b,{playerHasSurrendered:!0,close:!0})},z=b.getHandInfoAfterInsurance=function(a,b){var c=s(a,b),e=c.availableActions;return c.availableActions=d({},e,{stand:!0,hit:!0,surrender:!0,insurance:!1}),d({},c,{close:c.playerHasBlackjack})},A=b.isLuckyLucky=function(a,b){var c=l(a).hi+l(b).hi,d=l(a).lo+l(b).lo,e=l(a).hi+l(b).lo,f=l(a).lo+l(b).hi;return 19<=c&&21>=c||19<=d&&21>=d||19<=e&&21>=e||19<=f&&21>=f},B=b.getLuckyLuckyMultiplier=function(a,b){var c=[].concat(a,b),d=q(c),e=c.map(function(a){return a.value}).join(''),g=l(c);return(0,f.default)(e,d,g)},C=b.isPerfectPairs=function(a){return a[0].value===a[1].value},D=b.getSideBetsInfo=function(a,b,c,d){var e={luckyLucky:0,perfectPairs:0};if(a.luckyLucky&&b.luckyLucky&&A(c,d)){var f=B(c,d);e.luckyLucky=b.luckyLucky*f}return a.perfectPairs&&b.perfectPairs&&C(c)&&(e.perfectPairs=5*b.perfectPairs),e},E=b.isActionAllowed=function(a,b){if(a===h.RESTORE)return!0;return b===h.STAGE_READY?-1<[h.RESTORE,h.DEAL].indexOf(a):b===h.STAGE_PLAYER_TURN_RIGHT?-1<[h.STAND,h.INSURANCE,h.SURRENDER,h.SPLIT,h.HIT,h.DOUBLE].indexOf(a):b===h.STAGE_PLAYER_TURN_LEFT?-1<[h.STAND,h.HIT,h.DOUBLE].indexOf(a):b===h.SHOWDOWN?-1<[h.SHOWDOWN,h.STAND].indexOf(a):!(b!==h.STAGE_DEALER_TURN)&&-1<[h.DEALER_HIT].indexOf(a)},F=b.getPrize=function(a,b){var c=a.close,d=a.playerHasSurrendered,e=a.playerHasBlackjack,f=a.playerHasBusted,g=a.playerValue,h=g===void 0?{}:g,i=a.bet,j=i===void 0?0:i,k=m(l(b)),n=o(b);if(!(c!==void 0&&c))return 0;if(!(f!==void 0)||f)return 0;if(!(d!==void 0)||d)return j/2;if(e!==void 0&&e&&!n)return j+1.5*j;if(21<k)return j+j;var p=m(h);if(p>k)return j+j;return p===k?j:0},G=b.getPrizes=function(a){var b=a.history,c=a.handInfo,d=c.left,e=c.right,f=a.dealerCards,g=b.reduce(function(a,b){return a+=b.value,a},0),h=F(e,f),i=F(d,f);return{finalBet:g,wonOnRight:h,wonOnLeft:i}}},function(a,b,c){'use strict';Object.defineProperty(b,'__esModule',{value:!0}),b.defaultState=b.getRules=b.getDefaultSideBets=void 0;var d=c(0),e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(d),f=c(4),g=c(4);g.getRandom=function(a,b){var c=Number.MAX_VALUE,d=void 0,e=b-a+1;do{var f=crypto.randomBytes(4);d=f.readUInt8(0)}while(d>=c-c%e);return d%=e,d+a};var h=b.getDefaultSideBets=function(){var a=0<arguments.length&&arguments[0]!==void 0&&arguments[0];return{luckyLucky:a,perfectPairs:a,royalMatch:a,luckyLadies:a,inBet:a,MatchTheDealer:a}},i=b.getRules=function(a){var b=a.decks,c=b===void 0?1:b,d=a.standOnSoft17,e=a.double,f=e===void 0?'any':e,g=a.split,h=a.doubleAfterSplit,i=a.surrender,j=a.insurance,k=a.showdownAfterAceSplit;return{decks:c||1,standOnSoft17:!(d!==void 0)||d,double:f,split:!(g!==void 0)||g,doubleAfterSplit:!(h!==void 0)||h,surrender:!(i!==void 0)||i,insurance:!(j!==void 0)||j,showdownAfterAceSplit:!(k!==void 0)||k}},j=b.defaultState=function(a){return{hits:0,initialBet:0,finalBet:0,finalWin:0,wonOnRight:0,wonOnLeft:0,stage:e.STAGE_READY,deck:(0,f.shuffle)((0,f.newDecks)(a.decks)),handInfo:{left:{},right:{}},history:[],availableBets:h(!0),sideBetsInfo:{},rules:a,dealerHoleCard:null,dealerHasBlackjack:!1,dealerHasBusted:!1}}},function(a){a.exports=require('52-deck')},function(a,b,c){'use strict';function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}Object.defineProperty(b,'__esModule',{value:!0}),b.Game=b.actions=b.presets=b.engine=b.constants=void 0;var e=c(0),f=d(e),g=c(2),h=d(g),i=c(3),j=d(i),k=c(1),l=d(k),m=c(6),n=function(a){return a&&a.__esModule?a:{default:a}}(m);b.constants=f,b.engine=h,b.presets=j,b.actions=l,b.Game=n.default},function(a,b,c){'use strict';function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(b,'__esModule',{value:!0});var f=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c(0),i=d(h),j=c(2),k=d(j),l=c(3),m=c(1),n=function(a){var b=a.payload,c=b===void 0?{bet:0}:b;return Object.assign({},a,{value:c.bet||0,ts:new Date().getTime()})},o=function(){function a(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:(0,l.getRules)({});e(this,a),this.state={},this.state=b?Object.assign({},b):(0,l.defaultState)(c),this.dispatch=this.dispatch.bind(this),this.getState=this.getState.bind(this),this.setState=this.setState.bind(this),this.enforceRules=this.enforceRules.bind(this),this._dispatch=this._dispatch.bind(this)}return g(a,[{key:'canDouble',value:function(a,b){return'none'!==a&&('9or10'===a?9===b.hi||10===b.hi:'9or10or11'===a?9<=b.hi&&11>=b.hi:'9thru15'!==a||9<=b.hi&&15>=b.hi)}},{key:'enforceRules',value:function(a){var b=a.availableActions,c=a.playerValue,d=this.state,e=d.rules,f=d.history;return this.canDouble(e.double,c)||(b.double=!1),e.split||(b.split=!1),e.surrender||(b.surrender=!1),!e.doubleAfterSplit&&f.some(function(a){return a.type===i.SPLIT})&&(b.double=!1),e.insurance||(b.insurance=!1),a}},{key:'getState',value:function(){return f({},this.state)}},{key:'setState',value:function(a){this.state=f({},this.state,a)}},{key:'dispatch',value:function(a){var b=this.state,c=b.stage,d=b.handInfo,e=b.history,f=a.type,g=a.payload,h=void 0===g?{}:g,j=h.position,l=void 0===j?i.RIGHT:j,n=l===i.LEFT,o=e.some(function(a){return a.type===i.SPLIT}),p=d[l],q=k.isActionAllowed(f,c);if(!q)return this._dispatch(m.invalid(a,f+' is not allowed when stage is '+c));var r=[i.RESTORE,i.DEAL,i.SHOWDOWN];return q&&r.some(function(a){return a===f})?f===i.DEAL&&'number'!=typeof h.bet?this._dispatch(m.invalid(a,f+' without bet value on stage '+c)):this._dispatch(a):p.close?this._dispatch(m.invalid(a,f+' is not allowed because "'+l+'" side of the table is closed on "'+c+'"')):!n||o||e.some(function(a){return a.type===i.SPLIT})?n&&!d.right.close?this._dispatch(m.invalid(a,f+' is not allowed because you need to finish "left" hand "'+c+'"')):p.availableActions[f.toLowerCase()]?this._dispatch(a):this._dispatch(m.invalid(a,f+' is not currently allowed on position "'+l+'". Stage is "'+c+'"')):this._dispatch(m.invalid(a,f+' is not allowed because there is no SPLIT in current stage "'+c+'"'))}},{key:'_dispatch',value:function(a){switch(a.type){case i.DEAL:{var b=a.payload,c=b.bet,d=b.sideBets,e=this.state,g=e.rules.insurance,h=e.availableBets,j=e.history,o=e.hits,p=this.state.deck.splice(this.state.deck.length-2,2),q=this.state.deck.splice(this.state.deck.length-1,1),r=this.state.deck.splice(this.state.deck.length-1,1)[0],s=k.calculate(q),t=k.isBlackjack(q.concat([r])),u=this.enforceRules(k.getHandInfoAfterDeal(p,q,c));g&&1===s.lo&&(t=!1,u.availableActions=f({},u.availableActions,{stand:!1,double:!1,hit:!1,split:!1,surrender:!1}));var v=k.getSideBetsInfo(h,d,p,q),w=n(f({},a,{right:p,dealerCards:q}));if(this.setState({initialBet:c,stage:i.STAGE_PLAYER_TURN_RIGHT,dealerCards:q,dealerHoleCard:r,dealerValue:s,dealerHasBlackjack:t,deck:this.state.deck.filter(function(a){return-1===q.concat(p).indexOf(a)}),cardCount:k.countCards(p.concat(q)),handInfo:{left:{},right:u},sideBetsInfo:v,availableBets:(0,l.getDefaultSideBets)(!1),history:j.concat(w),hits:o+1}),u.playerHasBlackjack){this._dispatch(m.showdown());break}t&&!u.availableActions.insurance&&this._dispatch(m.showdown());break}case i.INSURANCE:{var x=a.payload.bet,y=void 0===x?0:x,z=this.state,A=z.sideBetsInfo,B=z.handInfo,C=z.dealerCards,D=z.dealerHoleCard,E=z.initialBet,F=z.history,G=z.hits,H=k.isBlackjack(C.concat([D])),I=0<y?E/2:0,J=1===C[0].value,K=J&&H&&0<I&&0<y?3*I:0,L=this.enforceRules(k.getHandInfoAfterInsurance(B.right.cards,C));L.bet=E,L.close=H;var M=n(f({},a,{payload:{bet:I||0}}));this.setState({handInfo:{left:{},right:L},history:F.concat(M),hits:G+1,sideBetsInfo:f({},A,{insurance:{risk:I,win:K}})}),H&&this._dispatch(m.showdown());break}case i.SPLIT:{var N=this.state,O=N.rules,P=N.initialBet,Q=N.handInfo,R=N.dealerCards,S=N.history,T=N.hits,U=this.state.deck,V=[Q.right.cards[0]],W=[Q.right.cards[1]],X=O.showdownAfterAceSplit&&1===W[0].value,Y=U.splice(U.length-2,1),Z=U.splice(U.length-1,1);U=U.filter(function(a){return-1===[Z,Y].indexOf(a)}),V.push(Z[0]),W.push(Y[0]);var $=n(f({},a,{payload:{bet:P},left:V,right:W})),_=this.enforceRules(k.getHandInfoAfterSplit(V,R,P)),aa=this.enforceRules(k.getHandInfoAfterSplit(W,R,P)),ba='';X?(ba=i.STAGE_SHOWDOWN,_.close=!0,aa.close=!0):aa.close?ba=i.STAGE_PLAYER_TURN_LEFT:ba=i.STAGE_PLAYER_TURN_RIGHT,aa.close&&_.close&&(ba=i.STAGE_SHOWDOWN),this.setState({stage:ba,handInfo:{left:_,right:aa},deck:U,history:S.concat($),hits:T+1}),ba===i.STAGE_SHOWDOWN&&this._dispatch(m.showdown());break}case i.HIT:{var ca='',da=this.state,ea=da.initialBet,fa=da.deck,ga=da.handInfo,ha=da.dealerCards,ia=da.cardCount,ja=da.history,ka=da.hits,la=a.payload.position,ma=fa.splice(fa.length-1,1),na=[],oa={},pa={},qa=ja.some(function(a){return a.type===i.SPLIT});la===i.LEFT?(na=ga.left.cards.concat(ma),oa=k.getHandInfoAfterHit(na,ha,ea,qa),pa=Object.assign({},ga.right),ca=oa.close?i.STAGE_SHOWDOWN:'player-turn-'+la):(na=ga.right.cards.concat(ma),pa=k.getHandInfoAfterHit(na,ha,ea,qa),oa=Object.assign({},ga.left),ca=pa.close?ja.some(function(a){return a.type===i.SPLIT})?i.STAGE_PLAYER_TURN_LEFT:i.STAGE_SHOWDOWN:'player-turn-'+la,pa.close&&oa.close&&(ca=i.STAGE_SHOWDOWN));var ra={};ra[la]=na;var sa=n(f({},a,ra));this.setState({stage:ca,handInfo:{left:oa,right:pa},deck:fa.filter(function(a){return-1===na.indexOf(a)}),cardCount:ia+k.countCards(ma),history:ja.concat(sa),hits:ka+1}),ca===i.STAGE_SHOWDOWN&&this._dispatch(m.showdown());break}case i.DOUBLE:{var ta='',ua=this.state,va=ua.initialBet,wa=ua.deck,xa=ua.handInfo,ya=ua.dealerCards,za=ua.cardCount,Aa=ua.history,Ba=ua.hits,Ca=a.payload.position,Da=wa.splice(wa.length-1,1),Ea=[],Fa={},Ga={},Ha=Aa.some(function(a){return a.type===i.SPLIT});Ca===i.LEFT?(Ga=Object.assign({},xa.right),Ea=xa.left.cards.concat(Da),Fa=k.getHandInfoAfterDouble(Ea,ya,va,Ha),ta=Fa.close?i.STAGE_SHOWDOWN:'player-turn-'+Ca):(Ea=xa.right.cards.concat(Da),Fa=Object.assign({},xa.left),Ga=k.getHandInfoAfterDouble(Ea,ya,va,Ha),ta=Ga.close?Aa.some(function(a){return a.type===i.SPLIT})?i.STAGE_PLAYER_TURN_LEFT:i.STAGE_SHOWDOWN:'player-turn-'+Ca);var Ia={};Ia[Ca]=Ea;var Ja=n(f({},a,{payload:{bet:va}},Ia));this.setState({stage:ta,handInfo:{left:Fa,right:Ga},deck:wa.filter(function(a){return-1===Ea.indexOf(a)}),cardCount:za+k.countCards(Da),history:Aa.concat(Ja),hits:Ba+1}),this._dispatch(m.stand(Ca));break}case i.STAND:{var Ka='',La=this.state,Ma=La.handInfo,Na=La.history,Oa=La.hits,Pa=a.payload.position,Qa={},Ra={},Sa=Na.some(function(a){return a.type===i.SPLIT});Pa===i.LEFT&&(Ra=Object.assign({},Ma.right),Qa=k.getHandInfoAfterStand(Ma.left),Ka=i.STAGE_SHOWDOWN),Pa===i.RIGHT&&(Qa=Object.assign({},Ma.left),Ra=k.getHandInfoAfterStand(Ma.right),Ra.close&&(Ka=i.STAGE_SHOWDOWN)),Sa&&(Ka=Ka===i.STAGE_SHOWDOWN?i.STAGE_SHOWDOWN:i.STAGE_PLAYER_TURN_LEFT),Sa&&!Qa.close&&(Ka=i.STAGE_PLAYER_TURN_LEFT);var Ta=n(a);this.setState({stage:Ka,handInfo:{left:Qa,right:Ra},history:Na.concat(Ta),hits:Oa+1}),Ka===i.STAGE_SHOWDOWN&&this._dispatch(m.showdown());break}case i.SHOWDOWN:{var Ua=this.state,Va=Ua.dealerHoleCard,Wa=Ua.handInfo,Xa=Ua.history,Ya=Ua.hits,Za=a.payload.dealerHoleCardOnly,$a=n(a);if(this.setState({stage:i.STAGE_DEALER_TURN,history:Xa.concat($a),hits:Ya+1}),this._dispatch(m.dealerHit({dealerHoleCard:Va})),Za){this.setState(f({stage:i.STAGE_DONE},k.getPrizes(this.state)));break}var _a=Xa.some(function(a){return a.type===i.SPLIT}),ab=(Wa.right.playerHasBusted||Wa.right.playerHasBlackjack)&&!_a;if(ab){this.setState(f({stage:i.STAGE_DONE},k.getPrizes(this.state)));break}var bb=_a&&(Wa.left.playerHasBusted||Wa.left.playerHasBlackjack)&&ab;if(bb){this.setState(f({stage:i.STAGE_DONE},k.getPrizes(this.state)));break}if(_a&&Wa.left.playerHasBusted&&Wa.right.playerHasBusted){this.setState(f({stage:i.STAGE_DONE},k.getPrizes(this.state)));break}for(;this.getState().stage===i.STAGE_DEALER_TURN;)this._dispatch(m.dealerHit());this.setState(f({},k.getPrizes(this.state)));break}case i.SURRENDER:{var cb=this.state,db=cb.handInfo,eb=cb.history,fb=cb.hits;db.right=k.getHandInfoAfterSurrender(db.right);var gb=n(a);this.setState({stage:i.STAGE_SHOWDOWN,handInfo:db,history:eb.concat(gb),hits:fb+1}),this._dispatch(m.showdown({dealerHoleCardOnly:!0}));break}case i.DEALER_HIT:{var hb=this.state,ib=hb.rules,jb=hb.deck,kb=hb.cardCount,lb=hb.history,mb=hb.hits,nb=a.payload.dealerHoleCard,ob=nb||jb.splice(jb.length-1,1)[0],pb=this.state.dealerCards.concat([ob]),qb=k.calculate(pb),rb=k.isBlackjack(pb),sb=21<qb.hi,tb=null;tb=17>qb.hi?i.STAGE_DEALER_TURN:!ib.standOnSoft17&&k.isSoftHand(pb)?i.STAGE_DEALER_TURN:i.STAGE_DONE;var ub=n(f({},a,{dealerCards:pb}));this.setState({stage:tb,dealerCards:pb,dealerValue:qb,dealerHasBlackjack:rb,dealerHasBusted:sb,deck:jb.filter(function(a){return-1===pb.indexOf(a)}),cardCount:kb+k.countCards([ob]),history:lb.concat(ub),hits:mb+1});break}default:{var vb=this.state,wb=vb.history,xb=vb.hits,yb=n(a);this.setState({hits:xb+1,history:wb.concat(yb)});break}}return this.getState()}}]),a}();b.default=o},function(a,b){'use strict';Object.defineProperty(b,'__esModule',{value:!0}),b.default=function(a,b,c){var d=''+a+(b?'s':'');return'777s'==d?200:'678s'==d?100:'777'==d?50:'678'==d?30:(21===c.hi||21===c.lo)&&b?10:21!==c.hi&&21!==c.lo||b?20===c.hi||20===c.lo?3:19===c.hi||19===c.lo?2:0:3}},function(a,b,c){a.exports=c(5)}]);
//# sourceMappingURL=index.js.map